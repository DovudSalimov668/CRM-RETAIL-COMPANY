{% extends 'crm/base.html' %}

{% block title %}Quote Detail - Retail CRM{% endblock %}

{% block content %}
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pb-2 mb-3 border-bottom">
    <h1 class="h2"><i class="fas fa-file-invoice-dollar"></i> Quote {{ quote.quote_number }}</h1>
    <div>
        <a href="{% url 'quote_update' quote.pk %}" class="btn btn-primary"><i class="fas fa-edit"></i> Edit</a>
        <a href="{% url 'quote_list' %}" class="btn btn-secondary">Back to List</a>
    </div>
</div>

<div class="card">
    <div class="card-header"><h5 class="mb-0">Quote Information</h5></div>
    <div class="card-body">
        <table class="table">
            <tr><th>Quote Number:</th><td><strong>{{ quote.quote_number }}</strong></td></tr>
            <tr><th>Customer:</th><td><a href="{% url 'customer_detail' quote.customer.pk %}">{{ quote.customer.first_name }} {{ quote.customer.last_name }}</a></td></tr>
            {% if quote.deal %}<tr><th>Deal:</th><td><a href="{% url 'deal_detail' quote.deal.pk %}">{{ quote.deal.title }}</a></td></tr>{% endif %}
            <tr><th>Status:</th><td><span class="badge bg-{% if quote.status == 'accepted' %}success{% elif quote.status == 'rejected' %}danger{% elif quote.is_expired %}warning{% else %}info{% endif %}">{{ quote.get_status_display }}{% if quote.is_expired %} (Expired){% endif %}</span></td></tr>
            <tr><th>Subtotal:</th><td>${{ quote.subtotal|floatformat:2 }}</td></tr>
            <tr><th>Tax:</th><td>${{ quote.tax|floatformat:2 }}</td></tr>
            <tr><th>Discount:</th><td>${{ quote.discount|floatformat:2 }}</td></tr>
            <tr><th>Total Amount:</th><td><strong>${{ quote.total_amount|floatformat:2 }}</strong></td></tr>
            <tr><th>Valid Until:</th><td>{{ quote.valid_until|date:"M d, Y" }}</td></tr>
            <tr><th>Created:</th><td>{{ quote.created_at|date:"M d, Y" }}</td></tr>
            <tr><th>Created By:</th><td>{{ quote.created_by.get_full_name|default:quote.created_by.username|default:"-" }}</td></tr>
            {% if quote.notes %}<tr><th>Notes:</th><td>{{ quote.notes }}</td></tr>{% endif %}
        </table>
    </div>
</div>
{% endblock %}

